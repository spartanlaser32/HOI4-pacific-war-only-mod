on_actions = {

	on_startup = {
		# Launch Ethipoian BoP events
	
		effect = {
			# League of Nations Members
			IF = {
				limit = {
					date < 1939.1.1 # don't bother with LoN after 1939
				}
				every_country = {
					limit = {
						OR = {
							### Original Members
							tag = ARG
							tag = BEL
							tag = BOL
							tag = ENG
							tag = AST
							tag = CAN
							tag = RAJ
							tag = NZL
							tag = SAF
							tag = CHI
							tag = COL
							tag = CUB
							tag = CZE
							tag = DEN
							tag = FRA
							tag = GRE
							tag = HAI
							tag = ITA
							tag = LIB
							tag = HOL
							tag = NOR
							tag = PAN
							tag = PER
							tag = PRU
							tag = POL
							tag = POR
							tag = ROM
							tag = SIA
							tag = SPR
							tag = SWE
							tag = SWI
							tag = URU
							tag = VEN
							tag = YUG
							### 1920
							tag = AUS
							tag = BUL
							tag = COS
							tag = FIN
							tag = LUX
							tag = ALB
							### 1921
							tag = EST
							tag = LAT
							tag = LIT
							### 1922
							tag = HUN
							### 1923
							tag = IRE
							tag = ETH
							### 1924
							tag = DOM
							### 1931
							tag = MEX
							### 1932
							tag = TUR
							tag = IRQ
							### 1934
							tag = SOV
							tag = AFG
							tag = ECU
						}
					}
					add_ideas = league_of_nations_member_idea
				}

			}
		}
	}


	#ROOT = country that joined a war
	#on_war is fired when a country goes to war against anyone and is not fired again when it enters war against another country unless it went to peace first
	
	#ROOT = attacking side
	#FROM = defending side
	#fired when two countries end up at war with each other ()
	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					SWI_bba = yes 
					has_dynamic_modifier = { modifier = SWI_swiss_gold_market}
				}
				every_enemy_country = {
					limit = {
						has_dynamic_modifier = { modifier = SWI_gold_trade_with_switzerland }
					}
					SWI_seize_gold = yes 
				}
			}
		}	
	}

	#ROOT = attacking side
	#FROM = defending side
	#fired when two countries end up at war with each other (on_war is fired when a country goes to war against anyone and is not fired again when it enters war against another country unless it went to peace first)
	on_declare_war = {
   	# Disable LoN if more members go to war with each other
		effect = {
			IF = {
				limit = {
					NOT = { has_global_flag = LoN_disbanded_flag }
					FROM = {
						# is_major = yes
						has_idea = league_of_nations_member_idea
					}
					ROOT = {
						is_major = yes
						has_idea = league_of_nations_member_idea
					}
				}
				set_global_flag = LoN_disbanded_flag
				set_variable = { global.LoN_attacker_country = ROOT }
				set_variable = { global.LoN_defender_country = FROM }
				news_event = { id = bba_news.0 hours = 4 random_hours = 8}
			}
		}
	}
	# ROOT is capitulated country, FROM is winner
	# ROOT is capitulated country, FROM is winner
	



	on_puppet = { #ROOT = nation being puppeted, FROM = overlord

		# In case of historical split of N and S Korea try to locate the correct leaders
		effect = {
			IF = {
				limit = {
					original_tag = KOR
					has_government = democratic
					NOT = {
						has_country_leader = {
							name = "Syngman Rhee"
							ruling_only = no
						}
					}
				}

				random_other_country = {
					limit = {
						original_tag = KOR
						has_country_leader = {
							name = "Syngman Rhee"
							ruling_only = no
						}
						NOT = { has_government = democratic }
					}
					every_character = {
						limit = {
							has_ideology_group = democratic
						}
						set_nationality =  ROOT
					}
				}
				retire_country_leader = yes

			}
			IF = {
				limit = {
					original_tag = KOR
					has_government = communism
					NOT = {
						has_country_leader = {
							name = "Kim Il-sung"
							ruling_only = no
						}
					}
				}

				random_other_country = {
					limit = {
						original_tag = KOR
						has_country_leader = {
							name = "Kim Il-sung"
							ruling_only = no
						}
						NOT = { has_government = communism }
					}
					every_character = {
						limit = {
							has_ideology_group = communism
						}
						set_nationality =  ROOT
					}
				}
				retire_country_leader = yes

			}
		}

		#Italian Confederation -> Add NS to new subjects
		effect = {
			if = {
				limit = {
					FROM = {
						original_tag = ITA
						has_completed_focus = ITA_the_italian_confederation
					}
				}
				if = {
					limit = {
						FROM = {
							has_completed_focus = ITA_planned_economy
						}
						NOT = { has_idea = ITA_italian_confederation_member_improved }
					}
					if = {
						limit = {
							has_idea = ITA_italian_confederation_member
						}
						swap_ideas = {
							remove_idea = ITA_italian_confederation_member
							add_idea = ITA_italian_confederation_member_improved
						}
					}
					else = {
						add_ideas = ITA_italian_confederation_member_improved
					}
				}
				else_if = {
					limit = {
						NOT = { has_idea = ITA_italian_confederation_member }
					}
					add_ideas = ITA_italian_confederation_member
				}
			}
		}
	}

	#used when puppeting through the occupied territories menu during peace time (or when releasing from non-core but owned territory, f.e. Britain releasing Egypt)
	#ROOT = nation being released, FROM = overlord
	on_release_as_puppet = {
		#Italian Confederation -> Add NS to new subjects
		effect = {
			if = {
				limit = {
					FROM = {
						original_tag = ITA
						has_completed_focus = ITA_the_italian_confederation
					}
				}
				if = {
					limit = {
						FROM = {
							has_completed_focus = ITA_planned_economy
						}
						NOT = { has_idea = ITA_italian_confederation_member_improved }
					}
					if = {
						limit = {
							has_idea = ITA_italian_confederation_member
						}
						swap_ideas = {
							remove_idea = ITA_italian_confederation_member
							add_idea = ITA_italian_confederation_member_improved
						}
					}
					else = {
						add_ideas = ITA_italian_confederation_member_improved
					}
				}
				else_if = {
					limit = {
						NOT = { has_idea = ITA_italian_confederation_member }
					}
					add_ideas = ITA_italian_confederation_member
				}
			}
		}
	}

	on_ruling_party_change = {
		#ITALY CHANGES IDEOLOGY -> Make sure it gets the appropriate name for Army NSs
		effect = {
			if = {
				limit = {
					original_tag = ITA
				}
				#log = "Updating NS names"
				mark_focus_tree_layout_dirty = yes
				ITA_replace_stuff_based_on_ideology_effect = yes
			}
		}
	}

	on_government_change = {
		effect = {
			#Change BoP when changing gov
			IF = {
				limit = {
					original_tag = ETH
					has_government = communism
				}
				set_power_balance = {
					id = ETH_centralization_balance
					left_side = ETH_decentralization_anarchist
					right_side = ETH_communist_side
				}
			}
			ELSE_IF = {
				limit = {
					original_tag = ETH
					NOT = { has_government = communism }
				}
				set_power_balance = {
					id = ETH_centralization_balance
					left_side = ETH_mesafint_side
					right_side = ETH_mekwanint_side
				}
			}
		}
		effect = { #This is so Switzerland can keep its SWI_biggest_fascist and SWI_best_dem_ally updated. 
			if ={
				limit = { 
					has_dlc = "By Blood Alone" 
					SWI = { exists = yes }
					any_owned_state = { is_capital = yes } # ignore civil war generated countries with no defined capital.
					OR = {
						tag = USA
						ROOT = {
							capital_scope = { is_on_continent = europe }
						}		
					}
				}
				SWI = {
					SWI_update_neighbor_opinion_balance = yes
					SWI_find_biggest_fascist_neighbor = yes
					SWI_find_best_democratic_ally = yes
					SWI_find_democratic_planes_seller = yes 
				}
			}
		}	
	}
	#on_unit_leader_promote_from_ranks_green
	on_unit_leader_promote_from_ranks_green = { # This uses the UNIT LEADER sub scope of a character, FROM == country
		effect = {
			IF = {
				limit = {
					OWNER = {
						original_tag = ETH
						has_completed_focus = ETH_expand_the_officer_corps
					}
				}
				if = {
					limit = {
						is_army_leader = yes
					}
					add_defense = 1
					add_attack= 1
				}
			}
		}
	}

	#Root is exile
	#From is old host
	on_exile_government_reinstated = {
		effect = {
			FROM = {
				IF = {
					limit = {
						ROOT = {
							tag = ETH
						}
						TAG = ETH.host_nation
						has_war_with = ITA
						has_wargoal_against = ITA
					}
					remove_wargoal = {
						target = ITA
						type = liberate_wargoal
					}
				}
			}
		}

		# Give promised states to Ethiopia
		effect = {
			IF = {
				limit = {
					ROOT = { tag = ETH }
				}
				ETH_transfer_promised_states = yes
			}
		}
	}

	#FROM is country getting invited. ROOT is the faction leader
	on_offer_join_faction = {
		effect = {
			if = {
				limit = {
					OR = {
						AND = {
							tag = ITA
							FROM = { tag = GER has_government = fascism }
						}
						AND = {
							tag = GER
							has_government = fascism
							FROM = { tag = ITA }
						}
					}
				}
				ITA = { set_country_flag = ITA_joined_faction_with_literally_hitler_achievement_flag }
			}
		}
	}
}



